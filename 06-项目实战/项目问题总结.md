# é¡¹ç›®é—®é¢˜æ€»ç»“

---
tags: [é—®é¢˜è§£å†³, é¡¹ç›®å®æˆ˜, è°ƒè¯•, æ€§èƒ½ä¼˜åŒ–, SpringBoot, TDengine, Redis]
created: 2026-02-21
updated: 2026-02-21
status: æŒç»­æ›´æ–°
importance: â­â­â­â­â­
---

## ğŸš¨ é«˜é¢‘é—®é¢˜é€ŸæŸ¥

### é—®é¢˜1ï¼šMapperæ³¨è§£æ‰«æå¤±è´¥ `#SpringBooté…ç½®`
**ç°è±¡**ï¼šæ·»åŠ  @Mapper æ³¨è§£åï¼Œä»æ— æ³•æ‰«åˆ°
**åŸå› **ï¼šé…ç½®äº† @MapperScanï¼Œå½“ä¸¤è€…éƒ½å­˜åœ¨æ—¶ï¼Œä»¥ @MapperScan ä¸ºä¸»
**è§£å†³**ï¼š
1. æ£€æŸ¥ @MapperScan é…ç½®çš„åŒ…è·¯å¾„
2. ç¡®ä¿ Mapper æ¥å£åœ¨æ‰«æèŒƒå›´å†…
3. é¿å… @MapperScan æ‰«åˆ°æ— å…³æ¥å£ï¼ˆå¦‚ Serviceï¼‰

**ç›¸å…³åŸç†**ï¼š[[03-springboot.md#MyBatisé…ç½®]]

---

### é—®é¢˜2ï¼šInvalid bound statement (not found) `#MyBatisé…ç½®`
**ç°è±¡**ï¼šMyBatis æŠ¥æ‰¾ä¸åˆ°å¯¹åº”çš„æ–¹æ³•
**åŸå› **ï¼šMapper å¯¹åº”çš„ XML ä¸­æ²¡æœ‰å¯¹åº”çš„æ–¹æ³•ï¼Œæˆ– @MapperScan æ‰«åˆ°äº†æ— å…³æ¥å£
**è§£å†³**ï¼š
1. æ£€æŸ¥ XML æ–‡ä»¶ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„æ–¹æ³•å®šä¹‰
2. ç¡®ä¿ @MapperScan ä¸è¦æ‰«åˆ° Service ç­‰æ— å…³æ¥å£
3. éªŒè¯æ–¹æ³•åå’Œå‚æ•°æ˜¯å¦åŒ¹é…

**ç›¸å…³åŸç†**ï¼š[[03-springboot.md#MyBatisé…ç½®]]

---

### é—®é¢˜3ï¼šSpring Security æƒé™åˆ›å»ºå¤±è´¥ `#Securityé…ç½®`
**ç°è±¡**ï¼šgranted authority textual representation is required
**åŸå› **ï¼šåˆ›å»º SimpleGrantedAuthority å‚æ•°ä¸èƒ½ä¸º null æˆ–ç©ºä¸²
**è§£å†³**ï¼š
1. æ£€æŸ¥æƒé™å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º
2. æ·»åŠ éç©ºæ ¡éªŒ
3. æä¾›é»˜è®¤æƒé™å€¼

**ç›¸å…³åŸç†**ï¼š[[03-springboot.md#Securityé…ç½®]]

---

### é—®é¢˜4ï¼šSpringCloud é…ç½®æ–‡ä»¶è¯»å–å¤±è´¥ `#SpringCloudé…ç½®`
**ç°è±¡**ï¼šNo spring.config.import property has been defined
**åŸå› **ï¼šSpringCloud 2020.* ç‰ˆæœ¬æŠŠ bootstrap ç¦ç”¨äº†
**è§£å†³**ï¼š
1. é‡æ–°å¯¼å…¥ bootstrap ä¾èµ–
2. æˆ–ä½¿ç”¨æ–°çš„é…ç½®å¯¼å…¥æ–¹å¼
3. é…ç½® spring.config.import å±æ€§

**ç›¸å…³åŸç†**ï¼š[[03-springcloud.md#é…ç½®ç®¡ç†]]

---

### é—®é¢˜5ï¼šSLF4J æ‰¾ä¸åˆ°å®ç° `#æ—¥å¿—é…ç½®`
**ç°è±¡**ï¼šæ²¡æœ‰ SpringBoot Starter æ—¶ï¼Œä½¿ç”¨ SLF4J æŠ¥é”™æ‰¾ä¸åˆ°
**åŸå› **ï¼šç¼ºå°‘ SLF4J å®ç°ä¾èµ–
**è§£å†³**ï¼š
```xml
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-api</artifactId>
    <version>1.7.36</version>
</dependency>
```

---

### é—®é¢˜6ï¼šTDengine æ•°æ®åº“åˆ›å»ºå¤±è´¥ `#TDengineæ•°æ®åº“`
**ç°è±¡**ï¼šDB error: Out of dnodes (0.000401s)
**åŸå› **ï¼šTDengine çš„æ•°æ®èŠ‚ç‚¹å·²ç»ç”¨å®Œï¼Œæ— æ³•ç»§ç»­åˆ›å»ºæ–°çš„æ•°æ®åº“
**è§£å†³**ï¼š
1. åˆ é™¤ä¸éœ€è¦çš„æ•°æ®åº“ï¼š`DROP DATABASE [IF EXISTS] db_name`
2. æ£€æŸ¥ç³»ç»Ÿèµ„æºé…ç½®
3. æ¸…ç†å†å²æ•°æ®

**ç›¸å…³åŸç†**ï¼š[[41-IOT.md#TDengineä½¿ç”¨]]

## ğŸ”§ å†…å­˜é—®é¢˜è¯Šæ–­

### å†…å­˜æ³„éœ²åˆ†ææµç¨‹

#### 1. è½¬å‚¨ hprof æ–‡ä»¶

**é¢„é…ç½® OOM æ—¶è‡ªåŠ¨è½¬å‚¨**ï¼š
```bash
java \
  -XX:+HeapDumpOnOutOfMemoryError \
  -XX:HeapDumpPath=/dump/heapdump.hprof \
  -jar your-application.jar
```

**Docker ä¸­å¯åŠ¨**ï¼š
```bash
docker run -d \
  -v /path/on/host/dump:/dump \
  your-docker-image \
  java -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/dump/heapdump.hprof -jar app.jar
```

**æ‰‹åŠ¨è½¬å‚¨**ï¼š
```shell
# è·å– Java è¿›ç¨‹ PID
jps -l

# ç”Ÿæˆå †è½¬å‚¨
jmap -dump:live,format=b,file=/dump/heapdump_manual.hprof PID
```

#### 2. MAT å·¥å…·åˆ†æ

**å·¥å…·ä¸‹è½½**ï¼šhttps://eclipse.dev/mat/

**å…³é”®åˆ†æè§†å›¾**ï¼š
- **Histogram è§†å›¾**ï¼šæŸ¥çœ‹å¯¹è±¡æ•°é‡å’Œå†…å­˜å ç”¨
- **Leak Suspects æŠ¥è¡¨**ï¼šç›´è§‚å±•ç°å†…å­˜æ³„æ¼å«Œç–‘ç‚¹
- **å¼•ç”¨å…³ç³»åˆ†æ**ï¼šwith outgoing/incoming references

#### 3. è§£å†³æ–¹æ¡ˆ
- å•ä¾‹æ¨¡å¼ç®¡ç†èµ„æº
- åŠæ—¶é‡Šæ”¾è¿æ¥å’Œèµ„æº
- é¿å…å¤§å¯¹è±¡é•¿æœŸæŒæœ‰

### å…¶ä»–è¯Šæ–­æŒ‡ä»¤

```shell
# æŸ¥çœ‹å †æ ˆ
jstack PID

# æŸ¥çœ‹ GC æƒ…å†µ
jstat -gcutil PID 1000

# æŸ¥çœ‹å †å¿«ç…§
jmap -histo:live PID

# æ–‡ä»¶æŸ¥çœ‹
tail -f xx.log
head -20 xx.log
```

## ğŸ”§ Redis æ€§èƒ½é—®é¢˜åˆ†æ

### CPU é«˜é—®é¢˜è¯Šæ–­

**åˆ†ææ–¹æ³•**ï¼š
```shell
# è·å–æ…¢æŸ¥è¯¢è®°å½•
slowlog len
slowlog get 100

# æŒ‡ä»¤çŠ¶æ€ç»Ÿè®¡
info commandstats

# å®æ—¶ç›‘æ§æŒ‡ä»¤
monitor
redis-cli -h 127.0.0.1 -p 6379 -a password monitor > a.txt
```

**ç»Ÿè®¡åˆ†æ**ï¼š
```shell
# ç»Ÿè®¡æ€»è®°å½•æ•°
cat a.txt | wc -l

# ç»Ÿè®¡æŸä¸ªæŒ‡ä»¤æ¬¡æ•°
cat a.txt | grep SCAN | wc -l

# æŸ¥çœ‹ CPU ä¿¡æ¯
redis info cpu
```

**å¸¸è§é—®é¢˜**ï¼š
- `keys *` å’Œ `scan` æŒ‡ä»¤è€—æ—¶è¿‡é•¿
- å¤§é‡å¹¶å‘æ“ä½œå¯¼è‡´ CPU é£™å‡
- ä¸åˆç†çš„æ•°æ®ç»“æ„ä½¿ç”¨

**ç›¸å…³åŸç†**ï¼š[[06-mq.md#Redisæ€§èƒ½ä¼˜åŒ–]]

## ğŸš€ å¾®æœåŠ¡å®æˆ˜æŠ€å·§

### 1. ç°åº¦å‘å¸ƒå®ç°
**æ ¸å¿ƒç‚¹**ï¼šè‡ªå®šä¹‰ LoadBalanceã€Nacos metadata æ ‡è¯†ã€HTTP å¤´æ ‡è¯†ã€OpenFeign é€ä¼ 

### 2. SSH è¿œç¨‹é€šé“è½¬å‘
**å®ç°æœ¬åœ°æ¥å…¥ç¯å¢ƒæµ‹è¯•**ï¼š
```bash
ssh -NR 6003:localhost:9080 root@139.9.177.138
```

### 3. Nacos æƒé‡ä¼˜é›…å‘å¸ƒ
**æµç¨‹**ï¼š
1. é…ç½®æƒé‡ä¸º 0
2. å¤„ç†å®Œæ‰€æœ‰è¯·æ±‚
3. åœæœºä¸‹çº¿å‡çº§
4. ä¸Šçº¿åæ¢å¤æƒé‡

**ä¼˜é›…ä¸‹çº¿åŒ…æ‹¬**ï¼š
- å¤„ç†æœªå®Œæˆçš„è¯·æ±‚ï¼Œä¸å†æ¥æ”¶æ–°è¯·æ±‚
- é‡Šæ”¾æ± åŒ–èµ„æºï¼šæ•°æ®åº“è¿æ¥æ± ã€HTTP è¿æ¥æ± 
- é‡Šæ”¾å¤„ç†çº¿ç¨‹
- ä»æ³¨å†Œä¸­å¿ƒä¸»åŠ¨æ³¨é”€

### 4. SSH è¿æ¥æ•°æ®åº“

**ä¾èµ–é…ç½®**ï¼š
```xml
<dependency>
    <groupId>com.jcraft</groupId>
    <artifactId>jsch</artifactId>
    <version>0.1.55</version>
</dependency>
```

**è¿æ¥å·¥å…·ç±»**ï¼š
```java
public class SshConnectionTool {
    private final static String SSH_USER = "root";
    private final static String SSH_PASSWORD = "password";
    private final static String SSH_REMOTE_SERVER = "server_ip";
    private final static int SSH_REMOTE_PORT = 22;
    private final static int LOCAL_PORT = 3307;
    private final static int REMOTE_PORT = 3306;

    private Session session;

    public SshConnectionTool() throws Throwable {
        JSch jSch = new JSch();
        session = jSch.getSession(SSH_USER, SSH_REMOTE_SERVER, SSH_REMOTE_PORT);
        session.setPassword(SSH_PASSWORD);

        Properties config = new Properties();
        config.put("StrictHostKeyChecking", "no");
        session.setConfig(config);

        session.connect();
        session.setPortForwardingL(LOCAL_PORT, "127.0.0.1", REMOTE_PORT);
    }

    public void closeSSH() {
        session.disconnect();
    }
}
```

## ğŸ”— ç›¸å…³æ–‡æ¡£
- **æŠ€æœ¯åŸç†**ï¼š[[03-springboot.md]] [[03-springcloud.md]] [[04-mysql.md]]
- **å·¥å…·ç¯å¢ƒ**ï¼š[[07-å·¥å…·ç¯å¢ƒ/éƒ¨ç½²è¿ç»´å®è·µ.md]]
- **è¡Œä¸šåº”ç”¨**ï¼š[[08-è¡Œä¸šåº”ç”¨/ç‰©è”ç½‘æŠ€æœ¯.md]]

## ğŸ·ï¸ æ ‡ç­¾
#é—®é¢˜è§£å†³ #é¡¹ç›®å®æˆ˜ #SpringBoot #å¾®æœåŠ¡ #æ€§èƒ½ä¼˜åŒ– #å†…å­˜åˆ†æ #Redis #TDengine